
{% load static %}
{% load bootstrap5 %}

{% if messages %}
{% for message in messages %}
{% if messages %}
{% for message in messages %}
<style>
    .form-group{
        margin-top:10px !important;
    }
    .independent{display: none;
    }
</style>
<script>
notify('{{message.level_tag}}', "{{message}}");
</script>

{% endfor %}

{% endif %}

{% endfor %}

{% endif %}
<div class="inner" style="min-height: 300px;">
    <span class="btn btn-danger" style="margin-top:5px;margin-left:5px;" id="back-to-view"><i class="fa fa-arrow-left"></i> Back</span>
   
    <div class="row">
        <div class="col-lg-12  center-align">
            <h6 style="text-align: center;"> {{Title}} </h6>
        </div>
    </div>
      <hr />
     <!--BLOCK SECTION -->
     <div class="row">
        <div class="col-lg-12">
     
            <form action="" method="POST" role="{{PageAction}}" name="{{success_url}}" title="{{not_success_url}}" class="col-md-12" id="DefaultForm">
				
                <div class="row" style="overflow: auto;padding: 10px;">
                    {% csrf_token %}
				
                    {{form.media}}
                    <!-- <div class="form-group col-sm-12">
                        CURRENT INSTITUTIONS
                        <input type="text" class="form-control" disabled readonly value="{{current.institution}}"> -->
                        <!-- <hr> -->
                    <!-- </div> -->
                    <!-- <div class="form-group col-sm-12" style="margin-top: 5px;">
                        SELECT INSTITUTION TO TRANFER THE USER
                        </div> -->
                    {% for item in institutions %}

                    {% if level == 'coordinator' %}
                    {% if item.id == current.region.id %}

                    {% else %}
                     <div class="form-group col-sm-3" >
                        <div class="col-sm-12" style="background-color: #ccc;padding:10px;border-radius: 5px;margin-top: 5px;">
                       <label>
                         <input type="checkbox" value="{{item.id}}" role="{{item.id}}" class="institution_checkboxes">
                         {{item.name}}
                       </label>
                       </div>
                     </div>
                     {% endif %}

                    {% else %}
                   {% if item.id == current.institution.id %}

                   {% else %}
                    <div class="form-group col-sm-3" >
                       <div class="col-sm-12" style="background-color: #ccc;padding:10px;border-radius: 5px;">
                      <label>
                        <input type="checkbox" value="{{item.id}}" role="{{item.id}}" class="institution_checkboxes">
                        {{item.name}}
                      </label>
                      </div>
                    </div>
                    {% endif %}
                    {% endif %}
                    {% endfor %}
                   </div>
				
                <input type="text" hidden value="{{level}}" name="level" id="level">
                <input type="text" hidden value="POST" name="level_name" id="level_name">
				<input type="text" hidden value="{{instance.id}}" name="instance" id="instance">
                <input type="text" hidden value="{{institution.id}}" name="institution" id="institution">
                <div class="col-sm-12" style="padding: 10px; ">
                    <button class="btn-success btn" style="float:right" id="SubmitQuery" role="{{PageAction}}">SAVE</button>
                </div>
			</div>
            </form>
       
        </div>

    </div>
  

</div>
<script>
    $(document).ready(function(){
    var csrfmiddlewaretoken= '{{csrf_token}}';
    // alert(csrfmiddlewaretoken)
    var level='{{level}}'
    var level_name='GET'
    var instance='{{instance.id}}'
    var current='{{current.institution.id}}'
        $(".institution_checkboxes").change(function(){
            if($(this).prop('checked')){
                var action='add'
                $(".institution_checkboxes").attr('checked',false)
                $(this).prop('checked',true)
            }else{
                var action='remove'
            }
            // var institution='{{user.institutionuser.institution.id}}';
    // alert(institution)
    var institution=$(this).attr('role')
     $.post('/save-transfer-now/',{current:current,instance:instance,action:action,institution:institution,level:level,csrfmiddlewaretoken:csrfmiddlewaretoken,level_name:level_name},function(data){
    //   $("#modal-staff").modal("show");                         
    //   $(".modal-content").html(data)
        //$('.content-wrapper').html(data)
 })
        })

        $("#back-to-view").click(function(){
   
        $("#modal-staff").modal("hide");
                                   
 

})
    })
</script>