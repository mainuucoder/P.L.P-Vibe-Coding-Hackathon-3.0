<style>
  table{
font-size: 13px !important;
width: 95%;
margin: auto;
text-align: center;
}

/*Make alternating colors for the table rows*/
/* .table tr:nth-child(odd){
background: #B8CAE4
}

.table tr:nth-child(even){
background: #dae5f4
} */

thead {
background-color: #34c38f;
color: white;
}
.display_table{
border-bottom-right-radius: 20px;
/*border-bottom-left-radius: 20px;*/
padding-left: 5px;
padding-right: 5px;
padding-bottom: 20px;
box-shadow: 12px 12px 20px 6px #2e6da4;
}
td{
  padding: 6px;
line-height: 1.428571429;
vertical-align: top;
border-top: 1px solid #dddddd;
text-align: justify;
font-size:16px;
}
.page_links{
cursor: pointer;

}
  
  .pagination { display: inline-block;}
  .pagination a { color: black; float: left; padding: 8px 16px; text-decoration: none;}
  .pagination a.active { background-color: #4CAF50; color: white;}
  .pagination a:hover:not(.active) {background-color: #ddd;}
  .actionbtns{
    cursor: pointer;
  
  }
  .headholder{
    margin-top: 5px;
    background-color: #495549 !important;
    font-weight: bold;
    color:#fff !important;
    text-align: center !important;
    text-transform: uppercase;
  }
   /* Style the tab */
.tab {
  overflow: hidden;
  border: 1px solid #ccc;
  background-color: #f1f1f1;
}

/* Style the buttons that are used to open the tab content */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class */
.active {
  background-color: #ccc  !important;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
} 
.tabcontent {
  animation: fadeEffect 1s; /* Fading effect takes 1 second */
}

/* Go from zero to full opacity */
@keyframes fadeEffect {
  from {opacity: 0;}
  to {opacity: 1;}
}
.company_tabs{
  min-height: 30px;
  margin-top: 4px;
  cursor: pointer;
  border-bottom: 1px solid #ccc;
  text-align: justify;
font-size: 13px;
padding: .50rem .50rem;
}
.graduation_tabs{
  min-height: 30px;
  margin-top: 4px;
  cursor: pointer;
  border-bottom: 1px dashed #ccc;
  text-align: justify;
font-size: 13px;
padding: .50rem .50rem;
padding-left: 20px;
}
.graduation_tabs:hover{
  background-color: #ccc;
    color: #fff !important;
}

.company_tabs:hover{
  background-color: #6C6E71;
    color: #fff !important;
}
.activetab{
  background-color: #6C6E71  !important;
    color: #fff !important;
}
#maininstitution_header{
  min-height: 30px;
  margin-top: 21px;
  font-size:16px;
  font-weight:bold;
  font-style: italic;
  padding-left: 10px;
}
  table{
font-size: 15px !important;
width: 95%;
margin: auto;
text-align: center;
}
th{
  font-size: 8px;
}

/*Make alternating colors for the table rows*/
/* .table tr:nth-child(odd){
background: #B8CAE4
}

.table tr:nth-child(even){
background: #dae5f4
} */

thead {
background-color: #34c38f;
color: white;
}
.display_table{
border-bottom-right-radius: 20px;
/*border-bottom-left-radius: 20px;*/
padding-left: 5px;
padding-right: 5px;
padding-bottom: 20px;
box-shadow: 12px 12px 20px 6px #2e6da4;
}
td{
  padding: 6px;
line-height: 1.428571429;
vertical-align: top;
border-top: 1px solid #dddddd;
text-align: justify;
font-size:10px;
}
.page_links{
cursor: pointer;

}
  
  .pagination { display: inline-block;}
  .pagination a { color: black; float: left; padding: 8px 16px; text-decoration: none;}
  .pagination a.active { background-color: #4CAF50; color: white;}
  .pagination a:hover:not(.active) {background-color: #ddd;}
  .actionbtns{
    cursor: pointer;
  
  }
  .page_links{
  cursor: pointer;

}
		
		.pagination { display: inline-block;}
		.pagination a { color: black; float: left; padding: 8px 16px; text-decoration: none;}
		.pagination a.active { background-color: #4CAF50; color: white;}
		.pagination a:hover:not(.active) {background-color: #ddd;}
		.actionbtns{
      cursor: pointer;
    
    }

.led-box {
  height: 11px;
  width: 25%;
  
  float: left;
}


.led-green {
  margin: 0 auto;
  width: 10px;
  height: 10px;
  background-color: #0dff00;
  border-radius: 50%;
  box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #1a823b 0 -1px 9px, rgba(0, 100, , 0.5) 0 2px 12px;
  -webkit-animation: blinkRed 1.5s infinite;
  -moz-animation: blinkRed 1.5s infinite;
  -ms-animation: blinkRed 1.5s infinite;
  -o-animation: blinkRed 1.5s infinite;
  animation: blinkRed 1.5s infinite;
}

@-webkit-keyframes blinkRed {
    from { background-color: #0dff00; }
    50% { background-color: #00aa2a; box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #1a823b 0 -1px 9px, rgba(255, 0, 0, 0.5) 0 2px 0;}
    to { background-color: #0dff00; }
}
@-moz-keyframes blinkRed {
    from { background-color: #0dff00; }
    50% { background-color: #00aa2a; box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #1a823b 0 -1px 9px, rgba(255, 0, 0, 0.5) 0 2px 0;}
    to { background-color: #0dff00; }
}
@-ms-keyframes blinkRed {
    from { background-color: #0dff00; }
    50% { background-color: #00aa2a; box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #1a823b 0 -1px 9px, rgba(255, 0, 0, 0.5) 0 2px 0;}
    to { background-color: #0dff00; }
}
@-o-keyframes blinkRed {
    from { background-color: #0dff00; }
    50% { background-color: #00aa2a; box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #1a823b 0 -1px 9px, rgba(255, 0, 0, 0.5) 0 2px 0;}
    to { background-color: #0dff00; }
}
@keyframes blinkRed {
    from { background-color: #0dff00; }
    50% { background-color: #00aa2a; box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #1a823b 0 -1px 9px, rgba(0, 100, 0, 0.5) 0 2px 0;}
    to { background-color: #0dff00; }
}









.dropbtn {
  color: #000;
  padding: 1px;
  font-size: 1px;
  border: none;
  cursor: pointer;
}

/* The container <div> - needed to position the dropdown content */
.dropdown {
  position: relative;
  display: inline-block;
}

/* Dropdown Content (Hidden by Default) */
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 200px;
  left:-144px;
  height: 300px !important;
  overflow: auto;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 9;
}

/* Links inside the dropdown */
.dropdown-content a {
  color: black;
  /* padding: 12px 16px; */
  text-decoration: none;
  display: block;
}
.btn-app-dropdown:hover{
  background-color: #ccc;
}
.btn-app-dropdown{
  Border-bottom:1px solid #ccc
}
/* Change color of dropdown links on hover */
/* .dropdown-content a:hover {background-color: #f1f1f1} */

/* Show the dropdown menu on hover */
.dropdown:hover .dropdown-content {
  display: block;
}

/* Change the background color of the dropdown button when the dropdown content is shown */
.dropdown:hover .dropbtn {
  
}








th{
  text-transform: uppercase;
}



.btn-app-dropdown{
  text-align: left;
}
.graphs{
  min-height: 200px;
}

</style>
{% if messages %}
{% for message in messages %}
<script>
notify('{{message.level_tag}}', "{{message}}");
</script>

{% endfor %}

{% endif %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.2/css/buttons.dataTables.min.css">
<!-- <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.2/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.2/js/buttons.html5.min.js"></script> -->

<script>
  $(document).ready(function() {
  $('#loadtable').DataTable( {
      dom: 'Bfrtip',
      buttons: [
          'copyHtml5',
          'excelHtml5',
          'csvHtml5',
          'pdfHtml5'
      ]
  } );
} );
</script>
  
<div class="card">
    <div class="card-body">
<div class="row">
  <div class="col-12" style="margin-bottom:3px ;">
    <div class="row">
      <div class="col-sm-8"></div>
      <div class="col-sm-4">
        <div class="row">

      <div class="btn btn-success col-sm-6" style="" id="Downloadcsv"><i class="fa fa-download" aria-hidden="true"></i> Sample csv</div>

          <div class="col-sm-1" ></div>
      <div class="btn btn-success col-sm-5" style="" id="Addusers"><i class="fa fa-upload" aria-hidden="true"></i> Upload Users</div>
       </div>
  </div>
</div>
</div>
</div>
    <div class="row">
      <div class="col-sm-2">
       <div class="col-sm-12">INSTITUTION</div>
        
            <div class="col-sm-12 company_tabs activetab" role="{{p.id}}" name="{{p.name}}">{{institutions.name|safe}}</div>
      
      </div> 
      <div class="col-sm-10">
        <div class="col-sm-12">{{institutions.name|safe}}</div>
<!-- Tab content -->
    <table class='table '  id="loadtable">
      <thead style="font-size: 11px;">
        <tr  style="font-size: 11px;background: #34c38f !important;">
         
          <th>NAME</th>
          <th>EMAIL</th>
          <th>ACTIONS</th>
        </tr>
      </thead>
    {% for p in institutionUsers %}
   
 <tr class="graduations graduationyear{{p.graduation_year.id}}"><td>
   {{p.user.first_name}} {{p.user.middle_name}} {{p.user.last_name}}
   
    </td>
  <td>{{p.user.email}}</td>
  <td>
  
    <div class="dropdown">
      <div class="dropbtn" style="color:#000;background:#fff;font-size:12px;"><i class="fa fa-edit"></i></div>
      <div class="dropdown-content row" style="min-height: 200px;max-height: 400px;overflow: auto;">
      
        <label style="font-weight: initial !important" class="">
        <span class="btn col-sm-12 btn-app-dropdown  " role='{{instance.id}}'>
        <input type="checkbox" role="is_active" name="{{p.user.id}}" {% if p.user.is_active %} checked {% endif %} class="update_user_rights">
         
          is_active
      
        </span>
      </label>
        <label style="font-weight: initial !important" class="">
        <span class="btn col-sm-12 btn-app-dropdown  " role='{{instance.id}}'>
             <input type="checkbox" role="is_admin" name="{{p.user.id}}"  {% if p.user.is_admin %} checked {% endif %} class="update_user_rights">
          is_admin
        </span>
       </label>
       <label style="font-weight: initial !important" class="">
          <span class="btn col-sm-12 btn-app-dropdown   " role='{{instance.id}}'>
           
            <input type="checkbox" role="is_staff" name="{{p.user.id}}" {% if p.user.is_staff %} checked {% endif %} class="update_user_rights">
         
            is_staff
     
         </span>
        </label>
        <label style="font-weight: initial !important" class="">
           <span class="btn col-sm-12 btn-app-dropdown  " role='{{instance.id}}'>
           
            <input type="checkbox" role="is_superuser" name="{{p.user.id}}" {% if p.user.is_superuser %} checked {% endif %} class="update_user_rights">
           
       
            is_superuser
         
          </span>
        </label>
        <label style="font-weight: initial !important" class="">
          <span class="btn col-sm-12 btn-app-dropdown " role='{{instance.id}}'>
           
            <input type="checkbox" role="is_organization_staff" name="{{p.user.id}}" {% if p.user.is_organization_staff %} checked {% endif %} class="update_user_rights">
            is_organization_staff
       
         </span>
        </label>
        <label style="font-weight: initial !important" class="">
          <span class="btn col-sm-12 btn-app-dropdown  " role='{{instance.id}}'>
           
            <input type="checkbox" role="is_ict_admin" name="{{p.user.id}}" {% if p.user.is_ict_admin %} checked {% endif %} class="update_user_rights">
           is_ict_admin
       
         </span>
        </label>
        <label style="font-weight: initial !important" class="">
         
            <span class="btn col-sm-12 btn-app-dropdown   " role='{{instance.id}}'>
            
              <input type="checkbox" role="is_staff" name="{{p.user.id}}" {% if p.user.is_staff %} checked {% endif %} class="update_user_rights">
               is_institution
          
           </span>
          </label>
          <label style="font-weight: initial !important" class="">
         
             <span class="btn col-sm-12 btn-app-dropdown  " role='{{instance.id}}'>
             
              <input type="checkbox" role="is_evaluator" name="{{p.user.id}}" {% if p.user.is_evaluator %} checked {% endif %} class="update_user_rights">
             is_evaluator
             
           </span>
          </label>
          <label style="font-weight: initial !important" class="">
         
            <span class="btn col-sm-12 btn-app-dropdown " role='{{instance.id}}'>
             
              <input type="checkbox" role="is_secretariat" name="{{p.user.id}}" {% if p.user.is_secretariat %} checked {% endif %} class="update_user_rights">
             is_secretariat
            
           </span>
          </label>
            <span style="min-height: 40px;"></span>
      </div>
    </div>







  </td>
  </tr>
    
     {% endfor %}
   
</table>
</div>
</div>
</div>
</div>






<div class="modal fade" id="modal-staff">
  <div class="modal-dialog modal-lg">
      <div class="modal-content">
      </div>
  </div>
</div>











<script>
  $(document).ready(function(){
    // alert()
    var csrfmiddlewaretoken= '{{csrf_token}}';
    $("#Downloadcsv").click(function() {
      var csrfmiddlewaretoken= '{{csrf_token}}';
 var url='/dashboard/users/download_sample_users_csv/';
 window.open(url, '_blank');
});
    $("#Addusers").click(function(){
     
     $.get('/dashboard/users/Create_user_upload_csv/',function(data){
      $("#modal-staff").modal("show");                         
      $(".modal-content").html(data)
        //$('.content-wrapper').html(data)
 })
 
 }) 
$(".update_user_rights").change(function(){
  var uuid=$(this).attr('name')
  var role=$(this).attr('role')
  if($(this).prop('checked')){
    var action='add'
  
  }else{
    var action='remove'
  }
$.post('/bursary/update_users_roles/',{role:role,uuid:uuid,action:action,csrfmiddlewaretoken:csrfmiddlewaretoken},function(data){

})

})









    $(".company_tabs").click(function(){
      var company=$(this).attr('role')
      $(".company_tabs").removeClass('activetab')
      $(this).addClass('activetab')
      $(".graduations").hide()
      $(".graduationyear"+company).show()
    })
    var csrfmiddlewaretoken= '{{csrf_token}}';
  var surveyId='{{survey.id}}'
    $(".btnback").click(function(){
    $.post('/dashboard/surveys/viewSurveys/',{csrfmiddlewaretoken:csrfmiddlewaretoken},function(data){

 $('.content-wrapper').html(data)
    })
  })




$(".tablinks").click(function(){
  $('.tablinks').removeClass('active')
  $(this).addClass('active')
  var graduation_year=$(this).attr('role')
  $('.tabcontent').hide()
  $('.graduates'+graduation_year).show()

})


})
// })
// function openCity(evt, cityName) {
//   // Declare all variables
//   var i, tabcontent, tablinks;

//   // Get all elements with class="tabcontent" and hide them
//   tabcontent = document.getElementsByClassName("tabcontent");
//   for (i = 0; i < tabcontent.length; i++) {
//     tabcontent[i].style.display = "none";
//   }

//   // Get all elements with class="tablinks" and remove the class "active"
//   tablinks = document.getElementsByClassName("tablinks");
//   for (i = 0; i < tablinks.length; i++) {
//     tablinks[i].className = tablinks[i].className.replace(" active", "");
//   }

//   // Show the current tab, and add an "active" class to the button that opened the tab
//   document.getElementById(cityName).style.display = "block";
//   evt.currentTarget.className += " active";
// } 
</script>