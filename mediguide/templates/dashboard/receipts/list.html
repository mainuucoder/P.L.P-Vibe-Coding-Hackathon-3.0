{% extends 'dashboard/base3.html' %}
{% load static %}
{% block content %}
{% if messages %}
{% for message in messages %}
<script>
  notify('{{message.level_tag}}', "{{message}}");
</script>

{% endfor %}

{% endif %}
<style>
    .action-btns {
        cursor: pointer;
    }
    .company_tabs{
  min-height: 30px;
  margin-top: 4px;
  cursor: pointer;
  border-bottom: 1px solid #ccc;
  text-align: justify;
font-size: 13px;
padding: .50rem .50rem;
}
.btn-institutions{
    margin-top: 3px;
    text-align: left;
}
.not_shown{
    display: none;
}
.dropbtn {
      color: #000;
      padding: 1px;
      font-size: 1px;
      border: none;
      cursor: pointer;
    }
    
    /* The container <div> - needed to position the dropdown content */
    .dropdown {
      position: relative;
      display: inline-block;
    }
    
    /* Dropdown Content (Hidden by Default) */
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 200px;
      left:-144px;
      height: 300px !important;
      overflow: auto;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 9;
    }
    
    /* Links inside the dropdown */
    .dropdown-content a {
      color: black;
      /* padding: 12px 16px; */
      text-decoration: none;
      display: block;
    }
    .btn-app-dropdown:hover{
      background-color: #ccc;
    }
    .btn-app-dropdown{
      Border-bottom:1px solid #ccc
    }
    /* Change color of dropdown links on hover */
    /* .dropdown-content a:hover {background-color: #f1f1f1} */
    
    /* Show the dropdown menu on hover */
    .dropdown:hover .dropdown-content {
      display: block;
    }
    
    /* Change the background color of the dropdown button when the dropdown content is shown */
    .dropdown:hover .dropbtn {
      
    }
    .actionbtns{
      text-align: left;
    }

    .button-register{
        cursor:pointer;
    }
    .btn-primary{
    background:#111c43 !important

}
</style>
<script src="{% static 'assets/js/jquery.min.js' %}"></script>
<div class="row">
    <div class="col-sm-3">
        <div class="card">
            <div class="card-body">
                <div class="col-sm-12">
                    <div class="col-sm-12">TRAINING CATEGORIES</div>
                    {% for item in categories %}
                    <div class="col-sm-12 btn-institutions btn {% if forloop.counter == 1 %} btn-success {% else %} btn-dark {% endif %}" role="{{item.id}}">{{forloop.counter}}.{{item}}</div>
            
                    {% endfor %}
                </div>
            </div>
        </div>

    </div>
    <div class="col-sm-9">
        
        <div class="card table-responsive">
          <div class="col-sm-12">
            <span style="float: right;margin-bottom: 5px;margin-top: 5px;" class="btn btn-success send-notifications">Resend notification <i class="fa fa-envelope"></i></span>
            </div>
            <div class="card-body">
           
                {% for item in list %}

                
                {% if item.category == basic_fundational %}
                <div class="col-sm-12 documents document{{item.category.id}} {% if forloop.counter == 1 %} {% else %} not_shown {% endif %}" style="padding:0px">
                  <div class="row">
                  <div class="col-sm-10" style="text-transform: uppercase;">TRAININGS UNDER {{item.category}}</div>
                  <!-- <div class="col-sm-2">
                      <span class="btn btn-success create-btn" role="{{item.category.id}}" style="float: right;"><i class="fa fa-plus"></i> Add</span>
                  </div> -->
              </div>
          <table class="table {% if user.is_lead_secretariat %} datatable-basic {% else %} file-export export-table table-striped  text-nowrap w-100 {% endif %}">
              <thead>
                  <th>#</th>
                  <th>NAME</th>
                  <th>TRAINEES REGISTERED </th>
                  <th>TRAINEES TRAINED </th>
                  <th>TRAINEES CERTIFIED </th>
                  <th>ACTION</th>
  
              </thead>
              <tbody>
                  <tr>
                      <td>1</td>
                      <td>{{item.category}}</td>
                      <td>{{item.category.trainees_registered}}</td>
                      <td>{{item.category.trainees_trained}}</td>
                      <td>{{item.category.trainees_certified}}</td>
                      <td>
                          <div class="dropdown" style="">
                              <div class="dropbtn" style="color:#000;background:#fff;font-size:12px;"><i class="fa fa-list"></i></div>
                              <div class="dropdown-content row" style="margin-top:-80px;min-height: 80px;max-height: 80px;overflow: auto;">
                             
                                <label style="font-weight: initial !important" class="">
                                  <a href="{% url 'training-view-trainee' foundational.id %}"><span class="btn col-sm-12 btn-app-dropdown final-actionbtns " name="training-view-trainee" role='{{foundational.id}}'>
                                Trainees
                                </span>
                                </a>
                              </label>
                            
                                <!-- <label style="font-weight: initial !important" class="">
                              <a href="{% url 'training-view-payments' foundational.id %}"> <span class="btn col-sm-12 btn-app-dropdown final-actionbtns view_requirements" name="training-view-payments" role='{{foundational.id}}'>
                                Payments
                                </span>
                              </a> 
                             
                               </label>
                               -->
                              </div>
                            </div>
                        
                      </td>
                  </tr>
              </tbody>
          </table>
      </div>
                {% elif item.category == basic_digital %}
                <div class="col-sm-12 documents document{{item.category.id}} {% if forloop.counter == 1 %} {% else %} not_shown {% endif %}" style="padding:0px">
                  <div class="row">
                  <div class="col-sm-10" style="text-transform: uppercase;">TRAININGS UNDER {{item.category}}</div>
                  <!-- <div class="col-sm-2">
                      <span class="btn btn-success create-btn" role="{{item.category.id}}" style="float: right;"><i class="fa fa-plus"></i> Add</span>
                  </div> -->
              </div>
          <table class="table {% if user.is_lead_secretariat %} datatable-basic {% else %} file-export {% endif %}">
              <thead>
                  <th>#</th>
                  <th>NAME</th>
                  <th>LEARNERS REGISTERED </th>
                  <th>LEARNERS TRAINED </th>
                  <th>LEARNERS CERTIFIED </th>
                  <th>ACTION</th>
  
              </thead>
              <tbody>
                  <tr>
                      <td>1</td>
                      <td>{{item.category}}</td>
                      <td>{{item.category.trainees_registered}}</td>
                      <td>{{item.category.trainees_trained}}</td>
                      <td>{{item.category.trainees_certified}}</td>
                      <td>
                          <div class="dropdown" style="">
                              <div class="dropbtn" style="color:#000;background:#fff;font-size:12px;"><i class="fa fa-list"></i></div>
                              <div class="dropdown-content row" style="margin-top:-80px;min-height: 80px;max-height: 80px;overflow: auto;">
                             
                                <label style="font-weight: initial !important" class="">
                                  <a href="{% url 'training-view-trainee' basic_training.id %}"><span class="btn col-sm-12 btn-app-dropdown final-actionbtns " name="training-view-trainee" role='{{basic_training.id}}'>
                                Trainees
                                </span>
                                </a>
                              </label>
                              {% if user.is_lead_secretariat %}

                              {% else %} 
                                <label style="font-weight: initial !important" class="">
                              <a href="{% url 'training-view-payments' basic_training.id %}"> <span class="btn col-sm-12 btn-app-dropdown final-actionbtns view_requirements" name="training-view-payments" role='{{basic_training.id}}'>
                                Receipts
                                </span>
                              </a> 
                             
                               </label>
                                {% endif %}
                              
                              </div>
                            </div>
                        
                      </td>
                  </tr>
              </tbody>
          </table>
      </div>
                {% else %}
                <div class="col-sm-12 documents document{{item.category.id}} {% if forloop.counter == 1 %} {% else %} not_shown {% endif %}" style="padding:0px">
                <div class="row">
                <div class="col-sm-10" style="text-transform: uppercase;">TRAININGS UNDER {{item.category}}</div>
                <!-- <div class="col-sm-2">
                    <span class="btn btn-success create-btn" role="{{item.category.id}}" style="float: right;"><i class="fa fa-plus"></i> Add</span>
                </div> -->
            </div>
        <table class="table {% if user.is_lead_secretariat %} datatable-basic {% else %} file-export {% endif %}">
            <thead>
                <th>#</th>
                <th>NAME</th>
                <th>LEARNERS REGISTERED </th>
                <th>LEARNERS TRAINED </th>
                <th>LEARNERS CERTIFIED </th>
                <th>ACTION</th>

            </thead>
            <tbody>
                {% for instance in item.list %}
                <tr>
                    <td>{{forloop.counter}}</td>
                    <td>{{instance.name}}</td>
                    <td>{{instance.trainees_registered}}</td>
                    <td>{{instance.trainees_trained}}</td>
                    <td>{{instance.trainees_certified}}</td>
                    <td>
                        <div class="dropdown" style="">
                            <div class="dropbtn" style="color:#000;background:#fff;font-size:12px;"><i class="fa fa-list"></i></div>
                            <div class="dropdown-content row" style="margin-top:-80px;min-height: 80px;max-height: 80px;overflow: auto;">
                           
                              <label style="font-weight: initial !important" class="">
                                <a href="{% url 'training-view-trainee' instance.id %}"><span class="btn col-sm-12 btn-app-dropdown final-actionbtns " name="training-view-trainee" role='{{instance.id}}'>
                              Trainees
                              </span>
                              </a>
                            </label>
                            {% if instance.training_category.price == '0' %}
                            {%  else %}
                              <label style="font-weight: initial !important" class="">
                            <a href="{% url 'training-view-payments' instance.id %}"> <span class="btn col-sm-12 btn-app-dropdown final-actionbtns view_requirements" name="training-view-payments" role='{{instance.id}}'>
                              Receipts
                              </span>
                            </a> 
                      
                             </label>
                             {% endif %}
                            </div>
                          </div>
                      
                    </td>
                </tr>
               
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
        {% endfor %}
    </div>
</div>
    </div>
</div>
<div class="modal fade" id="modal-staff">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
        </div>
    </div>
</div>


<script>
    $(document).ready(function(){
    var csrfmiddlewaretoken= '{{csrf_token}}';
    var level='{{level}}'
    var level_name='GET'
//     $(".final-actionbtns").click(function(){
//   var url=$(this).attr('name')
//   var instance=$(this).attr('role')
//   $.post('/'+url+'/',{level:level,level_name:level_name,instance:instance,csrfmiddlewaretoken:csrfmiddlewaretoken},function(data){
//     $(".data-views").hide()
//       $(".home").html(data).show()
      
//   })
//  })
$(".send-notifications").click(function(){
  // alert()
  $.get('/manage-payment-notifications/',function(data){
            $(".modal-content").html(data)
            $("#modal-staff").modal("show"); 
  
        })
})

        $(".btn-institutions").click(function(){
            var role=$(this).attr('role')
            $('.documents').hide()
            $('.document'+role).show()
            $(".btn-institutions").removeClass('btn-success').addClass('btn-dark')
            $(this).addClass('btn-success')

        })
        var level='{{level}}'
        // alert(level)
        var level_name='Get'
        var csrfmiddlewaretoken= '{{csrf_token}}';
       
        $(".create-btn").click(function(){
            var institution=$(this).attr('role')
            $.post('/templates/create-template/',{institution:institution,level_name:level_name,level:level,csrfmiddlewaretoken:csrfmiddlewaretoken},function(data){
            $(".modal-content").html(data)
            $("#modal-staff").modal("show"); 
  
        })
           
            // alert()
        })
        $(".action-btns").click(function(){
           var instance=$(this).attr('role')
           var action=$(this).attr('name')
           var level_name='Get'
           if (action=="delete"){
            var r = confirm("Are you sure you wish to delete?, click OK or CANCEL end this process?");
  if (r == true) {

    $.post('/templates/update-delete-template/',{level_name:level_name,action:action,instance:instance,level:level,csrfmiddlewaretoken:csrfmiddlewaretoken},function(data){
          if ($.trim(data)=='redirect'){

            window.location='/templates/manage-template/'+level
          }else{
            $(".modal-content").html(data)
            $("#modal-staff").modal("show");
          }
        })

  }else{

  }
           }else{

        
           $.post('/templates/update-delete-template/',{level_name:level_name,action:action,instance:instance,level:level,csrfmiddlewaretoken:csrfmiddlewaretoken},function(data){
          if ($.trim(data)=='redirect'){

            window.location='/templates/manage-template/'+level
          }else{
            $(".modal-content").html(data)
            $("#modal-staff").modal("show");
          }
      
        })
    }
        })
    })
</script>

{% endblock %}